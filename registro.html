<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Registro — GameCatalog</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <style>
        :root{--accent:#00ffe7;--dark:#0b0b12;--card:#1e1e3c}
        body{margin:0;font-family:'Orbitron',Arial,Helvetica,sans-serif;background:var(--dark);color:#fff;display:flex;flex-direction:column;min-height:100vh}
        header{padding:12px 18px;background:transparent}
        main{flex:1;display:flex;align-items:center;justify-content:center;padding:28px}
        .card{background:var(--card);padding:24px;border-radius:12px;max-width:540px;width:100%;box-shadow:0 10px 30px rgba(0,0,0,0.6)}
        h1{margin:0 0 12px;color:var(--accent)}
        label{display:block;margin-top:12px;font-size:14px;color:#ddd}
        input{width:100%;padding:10px;border-radius:8px;border:none;background:#111;color:#fff;margin-top:6px}
        .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:16px}
        .btn{background:var(--accent);color:#042;padding:10px 14px;border-radius:8px;border:none;cursor:pointer}
        .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff}
        .note{color:#bbb;margin-top:8px;font-size:13px}
        .err{color:#ffb0b0;margin-top:8px}
        .success{color:#b7ffd9;margin-top:8px}
        .small{font-size:13px;color:#aaa}
    </style>
</head>
<body>
    <header>
        <div style="max-width:1200px;margin:0 auto;display:flex;align-items:center;gap:12px">
            <a href="index.html" style="color:var(--accent);text-decoration:none;font-weight:700">GameCatalog</a>
            <nav style="margin-left:12px;display:flex;gap:12px"><a href="catalogo.html" style="color:#fff">Catálogo</a><a href="index.html" style="color:#fff">Inicio</a></nav>
        </div>
    </header>

    <main>
        <div class="card" role="form" aria-labelledby="formTitle">
            <h1 id="formTitle">Crear cuenta</h1>
            <p class="note">Regístrate para guardar favoritos y acceder a funciones personalizadas.</p>

            <form id="regForm" novalidate>
                <label for="email">Correo electrónico</label>
                <input id="email" type="email" autocomplete="email" placeholder="tu@correo.com" required>

                <label for="username">Nombre de usuario</label>
                <input id="username" type="text" autocomplete="username" placeholder="TuNombre" required>

                <label for="password">Contraseña</label>
                <input id="password" type="password" autocomplete="new-password" placeholder="Mínimo 8 caracteres" required>

                <label for="confirm">Confirmar contraseña</label>
                <input id="confirm" type="password" autocomplete="new-password" placeholder="Repite la contraseña" required>

                <div style="display:flex;align-items:center;gap:8px;margin-top:8px">
                    <input id="showPw" type="checkbox"><label for="showPw" class="small">Mostrar contraseña</label>
                </div>

                <div id="message" aria-live="polite"></div>

                <div class="actions">
                    <a href="index.html" class="btn-ghost btn" style="text-decoration:none;display:inline-flex;align-items:center;justify-content:center">Cancelar</a>
                    <button type="submit" id="submitBtn" class="btn">Registrarse</button>
                </div>
            </form>

            <p class="note" style="margin-top:12px">¿Ya tienes cuenta? <a href="index.html" style="color:var(--accent)">Entrar</a></p>
        </div>
    </main>

    <script>
        const form = document.getElementById('regForm');
        const email = document.getElementById('email');
        const username = document.getElementById('username');
        const password = document.getElementById('password');
        const confirm = document.getElementById('confirm');
        const message = document.getElementById('message');
        const showPw = document.getElementById('showPw');

        showPw.addEventListener('change', ()=>{
            const t = showPw.checked ? 'text' : 'password';
            password.type = t; confirm.type = t;
        });

        function setMessage(text, type){ message.textContent = text; message.className = type ? type : ''; }

        function validateEmail(v){ return /^\S+@\S+\.\S+$/.test(v); }

        form.addEventListener('submit', (e)=>{
            e.preventDefault();
            setMessage('');
            const em = email.value.trim().toLowerCase();
            const un = username.value.trim();
            const pw = password.value;
            const cpw = confirm.value;

            if(!validateEmail(em)){ setMessage('Introduce un correo electrónico válido.', 'err'); email.focus(); return; }
            if(un.length < 3){ setMessage('El nombre de usuario debe tener al menos 3 caracteres.', 'err'); username.focus(); return; }
            if(pw.length < 8){ setMessage('La contraseña debe tener al menos 8 caracteres.', 'err'); password.focus(); return; }
            if(pw !== cpw){ setMessage('Las contraseñas no coinciden.', 'err'); confirm.focus(); return; }

            // Load existing users from localStorage
            const users = JSON.parse(localStorage.getItem('gc_users')||'[]');
            if(users.some(u=>u.email === em)){ setMessage('Ya existe una cuenta con ese correo.', 'err'); email.focus(); return; }
            if(users.some(u=>u.username.toLowerCase() === un.toLowerCase())){ setMessage('El nombre de usuario ya está en uso.', 'err'); username.focus(); return; }

            // Demo storage: avoid plain-text passwords in production. Here we store base64 for convenience.
            const pwStored = btoa(pw);
            users.push({email: em, username: un, password: pwStored, created: new Date().toISOString()});
            localStorage.setItem('gc_users', JSON.stringify(users));

            // Optionally, auto-login by storing current user
            localStorage.setItem('gc_currentUser', JSON.stringify({email: em, username: un}));

            setMessage('Registro completado. Redirigiendo...', 'success');
            setTimeout(()=>{ window.location.href = 'index.html'; }, 1500);
        });
    </script>

    <script src="header.js"></script>
</body>
</html>
